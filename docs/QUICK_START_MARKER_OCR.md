# Быстрый старт: Marker + OCR

## Шаг 1: Открыть PDF

```
Файл → Открыть PDF (Ctrl+O)
```

Выберите PDF документ для обработки.

## Шаг 2: Marker разметка

```
Инструменты → Marker разметка (Ctrl+M)
```

- Marker автоматически определит блоки
- Типы: TEXT, TABLE, IMAGE
- Проверьте разметку справа в панели блоков

## Шаг 3: Запуск OCR по блокам

```
Инструменты → Запустить OCR (Ctrl+R)
```

### Настройки:

**Режим:**
- ✅ **По блокам** (учитывает вашу разметку)
- ❌ Вся страница

**Движок:**
- **Локальный VLM сервер** (рекомендуется)
  - URL: `http://127.0.0.1:1234/v1`
  - Модель: `qwen3-vl-32b-instruct`

ИЛИ

- **Chandra OCR**
  - Метод: HuggingFace

### Что происходит:

1. **TEXT блоки** → распознавание текста
2. **TABLE блоки** → распознавание таблиц
3. **IMAGE блоки** → детальное описание на русском:
   - Все видимые элементы
   - Текст на изображении
   - Технические параметры
   - Структура и компоненты

## Шаг 4: Генерация Markdown

После завершения OCR появится диалог:

```
Сгенерировать структурированный Markdown документ сейчас?
```

Нажмите **Да** → выберите путь для сохранения.

## Результат

### Файл: `recognized_document.md`

```markdown
# Страница 1

**Заголовок**

Распознанный текст заголовка...

**Таблица параметров**

| Параметр | Значение |
|----------|----------|
| Размер   | 100x200  |

**Схема системы**

*Изображение:*

Схема вентиляционной системы с тремя основными блоками:
1. Вентилятор (мощность 2.5 кВт)
2. Фильтр (класс F7)
3. Калорифер (производительность 15 кВт)
Все элементы соединены воздуховодами диаметром 250 мм.

![Изображение](temp_crops/page0_block123abc.png)

---
```

### Директория: `temp_crops/`

Кропы всех изображений:
- `page0_block123abc.png`
- `page0_block456def.png`
- ...

## Требования

### VLM сервер (для IMAGE описаний)

Запустите локальный VLM сервер с Qwen3-VL:

```bash
# LM Studio, vLLM или Ollama
# Модель: qwen3-vl-32b-instruct
# Адрес: http://127.0.0.1:1234/v1
```

### Chandra OCR (опционально)

```bash
pip install chandra-ocr
```

## Советы

1. **Проверьте типы блоков** после Marker разметки
   - Исправьте тип вручную если нужно
   - Правый клик → Изменить тип

2. **Для больших документов** используйте диапазон страниц
   - Marker разметка → укажите страницы

3. **IMAGE блоки** обрабатываются дольше
   - VLM создает подробное описание
   - Учитывайте время обработки

4. **Сохраняйте разметку**
   - Файл → Сохранить разметку
   - Можно использовать повторно

## Пример workflow

```
1. Открыть PDF
   └─> [test_document.pdf]

2. Marker разметка
   └─> Найдено: 15 блоков
       - TEXT: 8
       - TABLE: 4
       - IMAGE: 3

3. OCR по блокам
   └─> LocalVLM сервер
       ├─> TEXT: OCR распознавание
       ├─> TABLE: OCR распознавание
       └─> IMAGE: детальное описание РУ

4. Генерация MD
   └─> recognized_document.md
       └─> temp_crops/
           ├─> page0_block001.png
           ├─> page0_block007.png
           └─> page0_block012.png

✅ ГОТОВО!
```

## Дополнительная информация

- [`docs/MARKER_OCR_INTEGRATION.md`](MARKER_OCR_INTEGRATION.md) - полная документация
- [`docs/CHANDRA_OCR.md`](CHANDRA_OCR.md) - Chandra OCR
- [`docs/LOCAL_VLM_OCR.md`](LOCAL_VLM_OCR.md) - локальные VLM серверы
- [`examples/test_marker_ocr_workflow.py`](../examples/test_marker_ocr_workflow.py) - пример кода

