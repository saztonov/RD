# üöÄ –ë—ã—Å—Ç—Ä–∞—è –º–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ R2

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ë—ã–ª–æ ‚ùå
```
–§–∞–π–ª 1 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì
–§–∞–π–ª 2 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì
–§–∞–π–ª 3 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì
...
–§–∞–π–ª 100 ‚îÄ‚ñ∂ [====================] 100% ‚úì

‚è±Ô∏è –í—Ä–µ–º—è: ~30-40 —Å–µ–∫—É–Ω–¥
```

### –°—Ç–∞–ª–æ ‚úÖ
```
–§–∞–π–ª 1 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì
–§–∞–π–ª 2 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì   –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
–§–∞–π–ª 3 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì   –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
...                                         8 —Ñ–∞–π–ª–æ–≤!
–§–∞–π–ª 8 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì

–§–∞–π–ª 9 ‚îÄ‚îÄ‚ñ∂ [====================] 100% ‚úì
...

‚è±Ô∏è –í—Ä–µ–º—è: ~5-8 —Å–µ–∫—É–Ω–¥
üéâ –£—Å–∫–æ—Ä–µ–Ω–∏–µ: –≤ 5-6 —Ä–∞–∑!
```

## üéØ –ö–æ–≥–¥–∞ —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ

### 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ —Å crops
```
crops/
‚îú‚îÄ‚îÄ page_1_block_0.png   ‚îÄ‚îê
‚îú‚îÄ‚îÄ page_1_block_1.png    ‚îÇ
‚îú‚îÄ‚îÄ page_1_block_2.png    ‚îÇ
‚îú‚îÄ‚îÄ page_2_block_0.png    ‚îú‚îÄ‚ñ∂ –í—Å–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!
‚îú‚îÄ‚îÄ page_2_block_1.png    ‚îÇ
...                       ‚îÇ
‚îî‚îÄ‚îÄ page_50_block_5.png  ‚îÄ‚îò

üì¶ 100+ —Ñ–∞–π–ª–æ–≤ = 5-8 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 30-40!
```

### 2. –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
```
document.pdf              ‚îÄ‚îê
document_annotation.json   ‚îú‚îÄ‚ñ∂ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
document.md               ‚îÄ‚î§
crops/                     ‚îÇ
‚îú‚îÄ‚îÄ page_1_block_0.png     ‚îÇ
‚îú‚îÄ‚îÄ page_1_block_1.png     ‚îÇ
...                       ‚îÄ‚îò

üìÇ –í—Å—ë —Å—Ä–∞–∑—É, –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è!
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- **8 –ø–æ—Ç–æ–∫–æ–≤** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)
- –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. **R2DownloadWorker** - –¥–∏–∞–ª–æ–≥ "–§–∞–π–ª—ã –Ω–∞ R2"
2. **FileTransferWorker** - –æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
3. **R2Storage.TransferConfig** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ boto3

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è R2Storage
```python
TransferConfig(
    multipart_threshold=8 * 1024 * 1024,  # 8 MB
    max_concurrency=20,                   # 20 –ø–æ—Ç–æ–∫–æ–≤ –≤–Ω—É—Ç—Ä–∏ boto3
    multipart_chunksize=8 * 1024 * 1024,  # 8 MB —á–∞–Ω–∫–∏
    use_threads=True,
    max_io_queue=1000                     # –ë—É—Ñ–µ—Ä IO –æ–ø–µ—Ä–∞—Ü–∏–π
)
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ | –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | –ë—ã–ª–æ (—Å–µ–∫) | –°—Ç–∞–ª–æ (—Å–µ–∫) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|-------------------|--------------|------------|-------------|-----------|
| 10 —Ñ–∞–π–ª–æ–≤         | 100 KB       | 3-4        | 1-2         | 2-3x      |
| 50 —Ñ–∞–π–ª–æ–≤         | 100 KB       | 15-20      | 3-4         | 4-5x      |
| 100 —Ñ–∞–π–ª–æ–≤        | 100 KB       | 30-40      | 5-8         | 5-6x      |
| 200 —Ñ–∞–π–ª–æ–≤        | 50 KB        | 50-60      | 10-12       | 5-6x      |

## üé¨ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –°–ø–æ—Å–æ–± 1: –ú–∞—Å—Å–æ–≤–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
1. –í –¥–µ—Ä–µ–≤–µ –ø—Ä–æ–µ–∫—Ç–æ–≤: **–ü–ö–ú ‚Üí "–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ R2"**
2. –í—ã–¥–µ–ª–∏—Ç–µ –ø–∞–ø–∫—É `crops/` –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤
3. –ù–∞–∂–º–∏—Ç–µ **"üì• –°–∫–∞—á–∞—Ç—å"** –∏–ª–∏ **"üì• –°–∫–∞—á–∞—Ç—å –≤—Å—ë"**
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
5. üöÄ –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!

### –°–ø–æ—Å–æ–± 2: –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
1. –í –¥–µ—Ä–µ–≤–µ –ø—Ä–æ–µ–∫—Ç–æ–≤: **–î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ** –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
2. üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤—Å—ë –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
   - PDF —Ñ–∞–π–ª
   - –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - Markdown (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –í—Å–µ crops (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ –≤ 5-6 —Ä–∞–∑** –¥–ª—è –ø–∞–ø–æ–∫ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Ñ–∞–π–ª–æ–≤
‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
‚úÖ **–ú–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å** –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏
‚úÖ **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ** - –Ω–∏–∫–∞–∫–∏—Ö –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö
‚úÖ **–û–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ** - —Å—Ç–∞—Ä—ã–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üîç –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `docs/PARALLEL_DOWNLOAD_OPTIMIZATION.md`
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:** —Å–º. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π! üéâ**
